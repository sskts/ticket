{"version":3,"sources":["./app/modules/ticket/pages/ticket-index/ticket-index.component.html","./app/modules/ticket/pages/ticket-index/ticket-index.component.ts","./app/modules/ticket/parts/ticket-detail/ticket-detail.component.html","./app/modules/ticket/parts/ticket-detail/ticket-detail.component.ts","./app/modules/ticket/parts/ticket-not-found/ticket-not-found.component.html","./app/modules/ticket/parts/ticket-not-found/ticket-not-found.component.ts","./app/modules/ticket/ticket-routing.module.ts","./app/modules/ticket/ticket.module.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0GASoB,gJAAmE,KAC/D,mkBAA+C,yBAA5B,kBAA2B,oBAA9C,YAA+C,EAA5B,SAA2B;0GAP9D,uHAAsC,KAClC,sIAAgB,+MAEhB,MACA,qoBAAwD,IACpD,kJAA4B,KACxB,sdAAmE,iDAFrC,mBAAiB,SAAvD,YAAwD,EAAlB,SAAiB,GAE1C,mBAAwC,eAA7C,YAAmE,EAA9D,SAAwC;0GASzD,wlBAAsF,iDAA7B,mBAA4B,kBAArF,YAAsF,EAA7B,SAA4B;0GAhBzF,uHAAwB,KACpB,6YAAsC,IAetC,6YAAsF,iDAfjF,4CAAgC,GAArC,YAAsC,EAAjC,SAAgC,GAef,8CAAkC,GAAxD,YAAsF,EAAhE,SAAkC;wRAlBhE,8vBAA2C,IAC3C,kJAA4B,KACxB,6YAAwB,IAmB5B,qjBAAgC,IAChC,80BAA8B,iDAtBA,wBAAY,EAA1C,YAA2C,EAAb,SAAY,GAEjC,oBAAkB,YAAvB,YAAwB,EAAnB,SAAkB,GAmBd,mBAAkB,YAA/B,YAAgC,EAAnB,SAAkB,GACd,wBAAY,EAA7B,aAA8B,EAAb,SAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtB7B;;GAEG;AAC0D;AACpB;AAC+E;AACnC;AAGrF;IAkBI,8BACY,MAAc,EACd,WAA+B,EAChC,IAAiB;QAFhB,WAAM,GAAN,MAAM,CAAQ;QACd,gBAAW,GAAX,WAAW,CAAoB;QAChC,SAAI,GAAJ,IAAI,CAAa;IACxB,CAAC;IAEL;;;OAGG;IACU,uCAAQ,GAArB;;;;;;wBACI,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;wBAClB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;wBACtB,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;wBACjB,UAAU,GAA8B;4BAC1C,EAAE,EAAE,oBAAoB;4BACxB,SAAS,EAAE,IAAI;yBAClB,CAAC;wBACF,IAAI,CAAC,MAAM,GAAG;4BACV,UAAU,EAAE,UAAU;yBACzB,CAAC;wBACF,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;;;;6BAEzC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,EAApB,wBAAoB;wBACpB,KAAK;wBACL,qBAAM,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;;wBAD/B,KAAK;wBACL,SAA+B,CAAC;;;wBAEpC,SAAI;wBAAgB,qBAAM,IAAI,CAAC,WAAW,CAAC,oCAAoC,EAAE;;wBAAjF,GAAK,YAAY,GAAG,SAA6D,CAAC;;;;wBAElF,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,QAAQ,EAAE,EAAE,QAAQ,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;wBAC1D,OAAO,CAAC,GAAG,CAAC,KAAG,CAAC,CAAC;;;wBAGrB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;;;;;KAC1B;IAEM,yDAA0B,GAAjC;QACI,6CAA6C;QAC7C,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IACvB,CAAC;IAEM,uDAAwB,GAA/B;QACI,2CAA2C;QAC3C,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;IACtB,CAAC;IAEL,2BAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2GC1Ce,kJAA2D,uHAAO,4HAAI,uGAAM,4HAAI,uHAAO;2GACvF,2JAAkF,wDAA1B,iCAAyB,wBAAjF,YAAkF,EAA1B,SAAyB;2GAIzF,yKAEmG,oIACtF,4HAAI,KACb,gJAA0B,4OAAuE,MAAO,sHAAI,kYAClD,4HAAI,8KAC9C,4HAAI,iJAExB,iCAJ8B,6FAAuE;2GAKrG,yKAEmG,0IACrF,4HAAI,KACd,gJAA0B,4OAAuE,MAAO,sHAAI,kYAClD,4HAAI,8KAC9C,4HAAI,iJAExB,iCAJ8B,6FAAuE;2GA5BzG,kLAC0D,KACtD,sJAA+B,KAC3B,+IAAyB,KACrB,oJAA8B,qFAA0D,MACxF,4IAAsB,gFAAwB,MAC9C,+JAAyC,gFAA4C,MACrF,4IAAsB,iFAA6C,MAEvE,gJAAyB,KACrB,+YAA2D,IAC3D,+YAAkF,IAI1F,+YAEmG,GAFhG,mHAEgD,IAOnD,+YAEmG,GAFhG,mHAEgD,iDAhBxC,sCAA8B,iBAAjC,aAA2D,EAAxD,SAA8B,GAC5B,qCAA6B,iBAAlC,aAAkF,EAA7E,SAA6B,GAIvC,+VAEgD,IAFnD,aAEmG,EAFhG,SAEgD,GAOhD,+VAEgD,IAFnD,aAEmG,EAFhG,SAEgD,mDAtBb,kIAA0D,GAClE,+DAAwB,GACL,qFAA4C,GAC/D,uFAA6C;2GA5BnF,qIAA6D,KAEzD,uLAAgE,KAC5D,yLAAmE,KAC/D,wJAAkC,+FAAG,MACrC,0IAAoB,gFAA4C,MAEpE,yLAAmE,KAC/D,wJAAkC,qGAAI,MACtC,2IAAoB,mNAGd,IAEV,+JAAwC,KACpC,yJAAkC,0HAAU,MAC5C,2IAAoB,wFAClB,MAIV,wdAC0D,iDADrD,mBAA8E,8BAAnF,aAC0D,EADrD,SAA8E,mDAhBvD,mFAA4C,GAI5C,mqBAGd,GAIc,wLAClB;qPAjBd,8YAA6D,iDAAxD,2DAA8C,GAAnD,YAA6D,EAAxD,SAA8C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAnD;;GAEG;AACsD;AACxB;AACA;AAGjC;IAYI;QAFO,WAAM,GAAG,mCAAM,CAAC;IAEP,CAAC;IAEjB;;;OAGG;IACU,wCAAQ,GAArB;;;;;;wBACI,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC;wBACzB,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;wBACrB,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,WAAW,CAAC,kBAAkB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;wBAEnE,CAAC,GAAG,CAAC;;;6BAAE,EAAC,GAAG,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,MAAM;wBAEjD,UAAU,GAAG,mCAAM,CAAC,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,QAAQ,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,IAAI,EAAE,IAAI,mCAAM,EAAE,CAAC,IAAI,EAAE,CAAC;wBACzH,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;6BACjC,UAAU,EAAV,wBAAU;wBACJ,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC;wBAC9D,SAAS,GAAG,EAAE,CAAC;wBACf,MAAM,GAAkC;4BAC1C,MAAM,EAAE,CAAC;4BACT,KAAK,EAAE,CAAC,EAAE,GAAG,SAAS,CAAC;yBAC1B,CAAC;wBACa,qBAAM,gDAAgB,CAAC,WAAW,KAAK,SAAS,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,EAAE,MAAM,CAAC;;wBAArF,MAAM,GAAG,SAA4E;wBAC3F,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;;;wBAZwB,CAAC,EAAE;;;;;;KAenE;IAEL,4BAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;6GChDD,mKAAoD,KAChD,6IAAuB,KACnB,+NAAyG,qLAEzG,yDAJuB,mBAAoB,MAAnD,YAAoD,EAArB,SAAoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAnD;AAAA;AAAA;AAAoE;AAEpE;IASI;IAAgB,CAAC;IAEjB;;;OAGG;IACI,0CAAQ,GAAf;QAAA,iBAgBC;QAfG,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;QACb,IAAM,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;QAClD,IAAI,EAAE,KAAK,IAAI,EAAE;YACb,OAAO;SACV;QACD,IAAI,KAAK,GAAG,CAAC,CAAC;QACd,IAAM,KAAK,GAAG,EAAE,CAAC;QACjB,IAAM,YAAY,GAAG,GAAG,CAAC;QACzB,IAAI,CAAC,QAAQ,GAAG,WAAW,CAAC;YACxB,IAAI,EAAE,CAAC,YAAY,GAAG,CAAC,IAAI,KAAK,GAAG,KAAK,EAAE;gBACtC,aAAa,CAAC,KAAI,CAAC,QAAQ,CAAC,CAAC;gBAC7B,KAAI,CAAC,GAAG,GAAG,EAAE,CAAC,YAAY,CAAC;aAC9B;YACD,KAAK,EAAE,CAAC;QACZ,CAAC,EAAE,YAAY,CAAC,CAAC;IACrB,CAAC;IAEM,6CAAW,GAAlB;QACI,IAAI,IAAI,CAAC,QAAQ,KAAK,SAAS,EAAE;YAC7B,OAAO;SACV;QACD,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACjC,CAAC;IAEL,8BAAC;AAAD,CAAC;;;;;;;;;;;;;;ACzCD;AAAA;AAAA;AAAA;AAAuD;AAC4B;AAGnF,IAAM,MAAM,GAAW;IACrB,EAAE,IAAI,EAAE,EAAE,EAAE,SAAS,EAAE,+FAAoB,EAAE;CAC9C,CAAC;AAEF;IAAA;IAImC,CAAC;IAAD,0BAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJpC;AAAA;AAAA;IAAA;IAY4B,CAAC;IAAD,mBAAC;AAAD,CAAC","file":"modules-ticket-ticket-module-ngfactory.js","sourcesContent":["<app-campaign class=\"d-block\" url=\"ticket\"></app-campaign>\n<div class=\"pt-4 pb-5 px-3\">\n    <div *ngIf=\"!isLoading\">\n        <div *ngIf=\"reservations.length > 0;\">\n            <p class=\"mb-3\">\n                QRコードを入場口スタッフに提示してください。\n            </p>\n            <div class=\"swiper-container\" #swiper [swiper]=\"config\">\n                <div class=\"swiper-wrapper\">\n                    <div *ngFor=\"let reservation of reservations\" class=\"swiper-slide\">\n                        <app-ticket-detail [reservation]=\"reservation\"></app-ticket-detail>\n                    </div>\n                </div>\n            </div>\n            <!-- <div class=\"pagination-wrapper\">\n                <div class=\"swiper-pagination\"></div>\n            </div> -->\n        </div>\n        <app-ticket-not-found *ngIf=\"reservations.length === 0;\" [isMember]=\"user.isMember()\"></app-ticket-not-found>\n    </div>\n</div>\n<app-loading [show]=\"isLoading\"></app-loading>\n<app-information url=\"ticket\"></app-information>","/**\n * TicketComponent\n */\nimport { Component, OnInit, ViewChild } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { SwiperComponent, SwiperConfigInterface, SwiperDirective, SwiperPaginationInterface } from 'ngx-swiper-wrapper';\nimport { IReservation, ReservationService, UserService } from '../../../../services';\n\n\n@Component({\n    selector: 'app-ticket',\n    templateUrl: './ticket-index.component.html',\n    styleUrls: ['./ticket-index.component.scss']\n})\n/**\n * チケットホルダー\n * @class TicketIndexComponent\n * @implements OnInit\n */\nexport class TicketIndexComponent implements OnInit {\n    @ViewChild(SwiperComponent, { static: false }) public componentRef: SwiperComponent;\n    @ViewChild(SwiperDirective, { static: true }) public directiveRef: SwiperDirective;\n    public config: SwiperConfigInterface;\n    public isLoading: boolean;\n    public reservations: IReservation[];\n    public touch: boolean;\n\n    constructor(\n        private router: Router,\n        private reservation: ReservationService,\n        public user: UserService\n    ) { }\n\n    /**\n     * 初期化\n     * @method ngOnInit\n     */\n    public async ngOnInit() {\n        this.touch = true;\n        this.isLoading = true;\n        this.reservations = [];\n        const pagination: SwiperPaginationInterface = {\n            el: '.swiper-pagination',\n            clickable: true\n        };\n        this.config = {\n            pagination: pagination,\n        };\n        this.reservation.isMember = this.user.isMember();\n        try {\n            if (this.user.isMember()) {\n                // 会員\n                await this.user.updateAccount();\n            }\n            this.reservations = await this.reservation.getReservationByAppreciationDayOrder();\n        } catch (err) {\n            this.router.navigate(['/error', { redirect: '/ticket' }]);\n            console.log(err);\n        }\n\n        this.isLoading = false;\n    }\n\n    public slideChangeTransitionStart() {\n        // console.log('slideChangeTransitionStart');\n        this.touch = false;\n    }\n\n    public slideChangeTransitionEnd() {\n        // console.log('slideChangeTransitionEnd');\n        this.touch = true;\n    }\n\n}\n","<div *ngIf=\"reservation.reservedTickets.length > 0\" class=\"\">\n    \n    <ul class=\"bg-dark-gray text-white text-small container mw-100\">\n        <li class=\"row align-items-center border-bottom border-white py-2\">\n            <p class=\"col-md-4 text-md-right\">作品名</p>\n            <p class=\"col-md-8\">{{ reservation.reservationsFor[0].name.ja }}</p>\n        </li>\n        <li class=\"row align-items-center border-bottom border-white py-2\">\n            <p class=\"col-md-4 text-md-right\">上映日時</p>\n            <p class=\"col-md-8\">{{ moment(reservation.reservationsFor[0].coaInfo.dateJouei).format('YYYY/MM/DD (ddd)') }} {{\n                reservation.reservationsFor[0].startDate | timeFormat: reservation.reservationsFor[0].coaInfo.dateJouei\n                }}-{{ reservation.reservationsFor[0].endDate | timeFormat: reservation.reservationsFor[0].coaInfo.dateJouei\n                }}</p>\n        </li>\n        <li class=\"row align-items-center py-2\">\n            <p class=\"col-md-4 text-md-right\">劇場 / スクリーン</p>\n            <p class=\"col-md-8\">{{ reservation.reservationsFor[0].superEvent.location.name.ja }} / {{ reservation.reservationsFor[0].location.name.ja\n            }}</p>\n        </li>\n    </ul>\n\n    <div *ngFor=\"let reservedTicket of reservation.reservedTickets; let index = index;\"\n        class=\"detail bg-white p-3 border-bottom border-gray\">\n        <div class=\"position-relative\">\n            <div class=\"text-center\">\n                <div class=\"index text-small\">{{ (index + 1) }}/{{ reservation.reservedTickets.length }}</div>\n                <p class=\"text-small\">{{ confirmationNumber }}</p>\n                <p class=\"text-x-large font-weight-bold\">{{ reservedTicket.ticketedSeat.seatNumber }}</p>\n                <p class=\"text-small\">{{ reservedTicket.coaTicketInfo.ticketName }}</p>\n            </div>\n            <div class=\"text-center\">\n                <p *ngIf=\"!showQrCodeList[index]\" class=\"inner text-small\">鑑賞日前日から<br>QRコードが<br>表示されます。</p>\n                <img *ngIf=\"showQrCodeList[index]\" class=\"p-2 bg-white\" [src]=\"qrCodeList[index]\">\n            </div>\n        </div>\n        \n        <p *ngIf=\"(reservation.reservationsFor[0].superEvent.location.branchCode | slice : -2) === '20' \n            && reservedTicket.coaTicketInfo.spseatKbn === '003'\n            && reservedTicket.coaTicketInfo.spseatAdd2 > 0\" class=\"p-3 text-small border border-gray mt-3\">\n            【グランドクラス】<br>\n            <span class=\"text-danger\">本チケットには、ミールクーポン{{ reservedTicket.coaTicketInfo.spseatAdd2 }}円分が含まれています。</span><br>\n            4F・コンセッション、5F・クラッパーズダイナー、12F・バール パノーラマのいずれかでご提示の上、ご利用願います。<br>\n            ※お釣りのお返しは致しかねます。<br>\n            ※ご鑑賞日当日のみ有効\n        </p>\n        <p *ngIf=\"(reservation.reservationsFor[0].superEvent.location.branchCode | slice : -2) === '20' \n            && reservedTicket.coaTicketInfo.spseatKbn === '002'\n            && reservedTicket.coaTicketInfo.spseatAdd2 > 0\" class=\"p-3 text-small border border-gray mt-3\">\n            【プレミアムクラス】<br>\n            <span class=\"text-danger\">本チケットには、ミールクーポン{{ reservedTicket.coaTicketInfo.spseatAdd2 }}円分が含まれています。</span><br>\n            4F・コンセッション、5F・クラッパーズダイナー、12F・バール パノーラマのいずれかでご提示の上、ご利用願います。<br>\n            ※お釣りのお返しは致しかねます。<br>\n            ※ご鑑賞日当日のみ有効\n        </p>\n    </div>\n</div>","/**\n * TicketDetailComponent\n */\nimport { Component, Input, OnInit } from '@angular/core';\nimport * as moment from 'moment';\nimport * as qrcode from 'qrcode';\nimport { IReservation } from '../../../../services';\n\n@Component({\n    selector: 'app-ticket-detail',\n    templateUrl: './ticket-detail.component.html',\n    styleUrls: ['./ticket-detail.component.scss']\n})\nexport class TicketDetailComponent implements OnInit {\n    @Input() public reservation: IReservation;\n    public showQrCodeList: boolean[];\n    public qrCodeList: string[];\n    public confirmationNumber: string;\n    public moment = moment;\n\n    constructor() { }\n\n    /**\n     * 初期化\n     * @method ngOnInit\n     */\n    public async ngOnInit() {\n        this.showQrCodeList = [];\n        this.qrCodeList = [];\n        this.confirmationNumber = this.reservation.confirmationNumber.split('-')[0];\n\n        for (let i = 0; i < this.reservation.reservedTickets.length; i++) {\n            // QR生成\n            const showQrCode = moment(this.reservation.reservationsFor[i].startDate).subtract(24, 'hours').unix() <= moment().unix();\n            this.showQrCodeList.push(showQrCode);\n            if (showQrCode) {\n                const ticketToken = this.reservation.reservedTickets[i].ticketToken;\n                const basicSize = 21;\n                const option: qrcode.QRCodeToDataURLOptions = {\n                    margin: 0,\n                    scale: (80 / basicSize)\n                };\n                const qrCode = await qrcode.toDataURL(ticketToken !== undefined ? ticketToken : '', option);\n                this.qrCodeList.push(qrCode);\n            }\n        }\n    }\n\n}\n","<div class=\"position-absolute\" [style.top.px]=\"top\">\n    <div class=\"p-4 h-100\">\n        <p class=\"h-100 d-flex justify-content-center align-items-center border border-dark-gray text-dark-gray\">\n            現在鑑賞予定の作品はございません。\n        </p>\n    </div>\n</div>\n","import { Component, Input, OnDestroy, OnInit } from '@angular/core';\n\n@Component({\n    selector: 'app-ticket-not-found',\n    templateUrl: './ticket-not-found.component.html',\n    styleUrls: ['./ticket-not-found.component.scss']\n})\nexport class TicketNotFoundComponent implements OnInit, OnDestroy {\n    @Input() public isMember: boolean;\n    public interval: any;\n    public top: number;\n    constructor() { }\n\n    /**\n     * 初期化\n     * @method ngOnInit\n     */\n    public ngOnInit() {\n        this.top = 0;\n        const el = document.querySelector('app-campaign');\n        if (el === null) {\n            return;\n        }\n        let count = 0;\n        const limit = 10;\n        const intervalTime = 500;\n        this.interval = setInterval(() => {\n            if (el.clientHeight > 0 || count > limit) {\n                clearInterval(this.interval);\n                this.top = el.clientHeight;\n            }\n            count++;\n        }, intervalTime);\n    }\n\n    public ngOnDestroy() {\n        if (this.interval === undefined) {\n            return;\n        }\n        clearInterval(this.interval);\n    }\n\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { TicketIndexComponent } from './pages/ticket-index/ticket-index.component';\n\n\nconst routes: Routes = [\n  { path: '', component: TicketIndexComponent },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class TicketRoutingModule { }\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { SharedModule } from '../shared/shared.module';\nimport { TicketIndexComponent } from './pages/ticket-index/ticket-index.component';\nimport { TicketDetailComponent } from './parts/ticket-detail/ticket-detail.component';\nimport { TicketNotFoundComponent } from './parts/ticket-not-found/ticket-not-found.component';\nimport { TicketRoutingModule } from './ticket-routing.module';\n\n\n@NgModule({\n  declarations: [\n    TicketIndexComponent,\n    TicketDetailComponent,\n    TicketNotFoundComponent,\n  ],\n  imports: [\n    CommonModule,\n    TicketRoutingModule,\n    SharedModule,\n  ]\n})\nexport class TicketModule { }\n"],"sourceRoot":"webpack:///"}