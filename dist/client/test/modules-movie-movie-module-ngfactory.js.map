{"version":3,"sources":["./app/modules/movie/movie-routing.module.ts","./app/modules/movie/movie.module.ts","./app/modules/movie/pages/movie-index/movie-index.component.html","./app/modules/movie/pages/movie-index/movie-index.component.ts"],"names":[],"mappings":"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","file":"modules-movie-movie-module-ngfactory.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { MovieIndexComponent } from './pages/movie-index/movie-index.component';\n\n\nconst routes: Routes = [\n  { path: '', component: MovieIndexComponent },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class MovieRoutingModule { }\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { SharedModule } from '../shared/shared.module';\nimport { MovieRoutingModule } from './movie-routing.module';\nimport { MovieIndexComponent } from './pages/movie-index/movie-index.component';\n\n\n@NgModule({\n  declarations: [\n    MovieIndexComponent\n  ],\n  imports: [\n    CommonModule,\n    MovieRoutingModule,\n    SharedModule,\n  ]\n})\nexport class MovieModule { }\n","<div class=\"p-3\">\n    <div class=\"input-group align-items-center\">\n        <select class=\"form-control rounded\" name=\"theater\" [(ngModel)]=\"conditions.theater\" (change)=\"changeTheater()\">\n            <option value=\"\">選択してください</option>\n            <option *ngFor=\"let theater of theaters\" value=\"{{ theater.location.branchCode }}\">\n                {{ theater.name.ja }}</option>\n        </select>\n        <div class=\"input-group-append\">\n            <button class=\"btn btn-block p-2 ml-3 bg-white border border-gray\" (click)=\"update()\">\n                <img class=\"\" src=\"/assets/images/icon/reload_gray.svg\" width=\"24\" height=\"24\">\n            </button>\n        </div>\n    </div>\n</div>\n<div *ngIf=\"!isLoading && conditions.theater === ''\">\n</div>\n<div *ngIf=\"!isLoading && conditions.theater !== ''\">\n    <div class=\"\">\n        <p class=\"py-2 px-3 bg-gray font-weight-bold\">上映中</p>\n        <div class=\"bg-light-gray container\">\n            <ul *ngIf=\"nowShowing.length > 0\" class=\"row p-2\">\n                <li *ngFor=\"let data of nowShowing\" class=\"col-4 p-1\">\n                    <div (click)=\"openDetail({data: data, routerLink: true})\">\n                        <div class=\"mb-1\">\n                            <img *ngIf=\"data.title.image\" [src]=\"data.title.image\" class=\"w-100\" [alt]=\"data.title.name\">\n                            <img *ngIf=\"!data.title.image\" src=\"/assets/images/movie/no_image.png\" class=\"w-100\" alt=\"\">\n                        </div>\n                        <p class=\"text-x-small\">{{ data.title.name }}</p>\n                    </div>\n                </li>\n            </ul>\n            <p class=\"py-5 text-center\" *ngIf=\"nowShowing.length === 0\">上映中作品がありません</p>\n        </div>\n    </div>\n    <div class=\"future\">\n        <p class=\"px-3 py-2 bg-gold font-weight-bold\">上映予定</p>\n        <div class=\"bg-light-gold container\">\n            <ul *ngIf=\"comingSoon.length > 0\" class=\"row p-2\">\n                <li *ngFor=\"let data of comingSoon\" class=\"col-4 p-1\">\n                    <div (click)=\"openDetail({data: data, routerLink: false})\">\n                        <div class=\"mb-1\">\n                            <img *ngIf=\"data.title.image\" [src]=\"data.title.image\" class=\"w-100\" [alt]=\"data.title.name\">\n                            <img *ngIf=\"!data.title.image\" src=\"/assets/images/movie/no_image.png\" class=\"w-100\" alt=\"\">\n                        </div>\n                        <p class=\"text-x-small\">{{ data.title.name }}</p>\n                    </div>\n                </li>\n            </ul>\n            <p class=\"py-5 text-center\" *ngIf=\"comingSoon.length === 0\">上映予定作品がありません</p>\n        </div>\n    </div>\n</div>\n\n<app-loading [show]=\"isLoading\"></app-loading>","/**\n * TicketComponent\n */\nimport { Component, OnInit } from '@angular/core';\nimport { factory } from '@cinerino/api-javascript-client';\nimport { BsModalService } from 'ngx-bootstrap/modal';\nimport { cms } from '../../../../models';\nimport { CmsService, IPurchaseConditions, MasterService, SelectService, UtilService } from '../../../../services';\nimport { MovieDetailModalComponent } from '../../../shared/components/parts/movie-detail-modal/movie-detail-modal.component';\n\n\n@Component({\n    selector: 'app-movie',\n    templateUrl: './movie-index.component.html',\n    styleUrls: ['./movie-index.component.scss']\n})\n/**\n * 作品情報\n * @class MovieIndexComponent\n * @implements OnInit\n */\nexport class MovieIndexComponent implements OnInit {\n    public isLoading: boolean;\n    public theaters: factory.seller.IOrganization<factory.seller.IAttributes<factory.organizationType>>[];\n    public conditions: IPurchaseConditions;\n    public nowShowing: { title: cms.schedule.ITitle, schedule: cms.schedule.ISchedule[] }[];\n    public comingSoon: { title: cms.schedule.ITitle, schedule: cms.schedule.ISchedule[] }[];\n\n    constructor(\n        private cmsService: CmsService,\n        private masterService: MasterService,\n        private selectService: SelectService,\n        private utilService: UtilService,\n        private modal: BsModalService,\n    ) { }\n\n    /**\n     * 初期化\n     * @method ngOnInit\n     */\n    public async ngOnInit() {\n        this.isLoading = true;\n        try {\n            this.conditions = this.selectService.data.purchase;\n            this.theaters = await this.masterService.searchSeller(\n                { typeOfs: [factory.organizationType.MovieTheater] },\n                { exclude: true, sort: true }\n            );\n            await this.getSchedule();\n        } catch (error) {\n            this.utilService.openAlert({\n                title: 'エラー',\n                body: `上映情報が取得に失敗しました。`\n            });\n            console.error(error);\n        }\n        this.isLoading = false;\n    }\n\n    private async getSchedule() {\n        this.nowShowing = [];\n        this.comingSoon = [];\n        if (this.conditions.theater === '') {\n            return;\n        }\n        const theaterCode = this.conditions.theater;\n        this.nowShowing = this.schedule2Title({\n            schedule: (await this.cmsService.getSchedule({\n                scheduleType: 'nowShowing',\n                theaterCode\n            })).schedules\n        });\n        this.comingSoon = this.schedule2Title({\n            schedule: (await this.cmsService.getSchedule({\n                scheduleType: 'comingSoon',\n                theaterCode\n            })).schedules\n        });\n    }\n\n    /**\n     * 上映情報を作品別に変換\n     */\n    private schedule2Title(params: {\n        schedule: cms.schedule.ISchedule[]\n    }) {\n        const result: { title: cms.schedule.ITitle, schedule: cms.schedule.ISchedule[] }[] = [];\n        const schedule = params.schedule;\n        schedule.forEach(s => {\n            const findTitle = result.find(r => r.title.id === s.title.id);\n            if (findTitle === undefined) {\n                result.push({ title: s.title, schedule: [s] });\n                return;\n            }\n            findTitle.schedule.push(s);\n        });\n        return result;\n    }\n\n    /**\n     * 劇場変更\n     */\n    public async changeTheater() {\n        this.selectService.data.purchase.theater = this.conditions.theater;\n        this.selectService.save();\n        this.isLoading = true;\n        try {\n            await this.getSchedule();\n        } catch (error) {\n            this.utilService.openAlert({\n                title: 'エラー',\n                body: `上映情報が取得に失敗しました。`\n            });\n            console.error(error);\n        }\n        this.isLoading = false;\n    }\n\n    /**\n     * 更新\n     */\n    public async update() {\n        this.isLoading = true;\n        try {\n            await this.getSchedule();\n        } catch (error) {\n            this.utilService.openAlert({\n                title: 'エラー',\n                body: `上映情報が取得に失敗しました。`\n            });\n            console.error(error);\n        }\n        this.isLoading = false;\n    }\n\n    public openDetail(params: {\n        data: { title: cms.schedule.ITitle, schedule: cms.schedule.ISchedule[] },\n        routerLink: boolean\n    }) {\n        this.modal.show(MovieDetailModalComponent, {\n            class: 'modal-dialog-centered',\n            initialState: {\n               data: params.data,\n               routerLink: params.routerLink\n            }\n        });\n    }\n\n}\n"],"sourceRoot":"webpack:///"}